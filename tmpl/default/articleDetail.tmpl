<? var mainImg = d.preview_imgs && d.preview_imgs[0] ? d.preview_imgs[0].url : '' ?>
<? var reviewsCount = parseInt(d.statistics.good_reviews) + parseInt(d.statistics.bad_reviews); ?>
<? var price = (d.collection == 'unit' ? 'от ' : '') + d.price + ' ' + d.currency ?>

<img src="//shop.digiseller.ru/xml/shop_views.asp?idd=<?= d.id ?>&ids=<?= opts.seller_id ?>" width="0" height="0" />

<div class="digiseller-productpge">
	<h1>
		<?= d.name ?>&nbsp;
		<? switch(d.label) {
			case 'top': ?>
				<span class="digiseller-labellider"><?= opts.i18n['leader!'] ?></span>
				<? break;
			case 'sale': ?>
				<span class="digiseller-labelaction"><?= opts.i18n['action!'] ?></span>
				<? break;
			case 'new': ?>
				<span class="digiseller-labelnew"><?= opts.i18n['new!'] ?></span>
				<? break;
		} ?>
	</h1>
	
	<div class="digiseller-breadcrumbs">
		<a title="<?= opts.i18n['shop'] ?>" onclick="location.hash='#!digiseller/home';"><?= opts.i18n['shop'] ?></a> &gt;&nbsp;
		<? if (d.breadCrumbs) {			
			for (var i = 0, l = d.breadCrumbs.length; i < l - 1; i++) { ?>
				<a title="<?= d.breadCrumbs[i].name ?>" onclick="location.hash='#!digiseller/articles/<?= d.breadCrumbs[i].id ?>';"><?= d.breadCrumbs[i].name ?></a> &gt;&nbsp;
			<? } ?>
			<a title="<?= d.breadCrumbs[l - 1].name ?>" onclick="location.hash='#!digiseller/articles/<?= d.breadCrumbs[l - 1].id ?>';"><?= d.breadCrumbs[l - 1].name ?></a>
		<? } ?>
	</div>

	<? if (d.id_prev !== '0' || d.id_next !== '0') { ?>
		<div class="digiseller-product-toggle">
			<? if (d.id_prev !== '0') { ?>
				<span>&larr; </span><a onclick="location.hash='#!digiseller/detail/<?= d.id_prev ?>';"><?= opts.i18n['prevArticle'] ?></a> &nbsp;&nbsp;
			<? } ?>
			|
			<? if (d.id_next !== '0') { ?>
				&nbsp;&nbsp; <a onclick="location.hash='#!digiseller/detail/<?= d.id_next ?>';"><?= opts.i18n['nextArticle'] ?></a><span> &rarr;</span>
			<? } ?>
		</div>
	<? } ?>
	
	<div class="digiseller-options">
		<span class="digiseller-social">
			<a class="digiseller-social-fb" title="<?= opts.i18n['shareInFacebook'] ?>" data-action="share" data-type="fb" data-title="<?= d.name ?> / <?= price ?>" data-img="<?= mainImg ?>"></a>
			<a class="digiseller-social-vk" title="<?= opts.i18n['shareInVK'] ?>" data-action="share" data-type="vk" data-title="<?= d.name ?> / <?= price ?>" data-img="<?= mainImg ?>"></a>
			<a class="digiseller-social-tw" title="<?= opts.i18n['shareInTwitter'] ?>" data-action="share" data-type="tw" data-title="<?= d.name ?> / <?= price ?>"></a>
			<a class="digiseller-social-wm" title="<?= opts.i18n['shareInWME'] ?>" data-action="share" data-type="wme" data-title="<?= d.name ?> / <?= price ?>" data-img="<?= mainImg ?>"></a>
		</span>

		<div id="digiseller-currency"></div>
	</div>
	
	<div class="digiseller-product-details">		
		<div class="digiseller-product-left">
			<? if (mainImg) { ?>
				<a href="<?= mainImg ?>" target="_blank" id="digiseller-article-img-preview" data-type="img">
					<img src="//graph.digiseller.ru/img.ashx?idp=<?= d.preview_imgs[0].id ?>&<?= d.preview_imgs[0].height > d.preview_imgs[0].width ? 'h' : 'w' ?>=<?= opts.imgsize_infopage ?>" alt="<?= name ?>" />
				</a>
			<? } else { ?>
				<img src="//graph.digiseller.ru/img.ashx?id_d=1&maxlength=<?= opts.imgsize_infopage ?>" alt="<?= d.name ?>" />
			<? } ?>
			
			<? if (d.preview_imgs || d.preview_videos) { ?>
				<div class="digiseller-left-thumbs" id="digiseller-article-thumbs">
					<? if (d.preview_imgs && d.preview_imgs.length > 1) { ?>
						<? for (var i = 0, l = d.preview_imgs.length; i < l; i++) { ?>
							<a href="<?= d.preview_imgs[i].url ?>" data-type="img">
								<img src="//graph.digiseller.ru/img.ashx?idp=<?= d.preview_imgs[i].id ?>&maxlength=80&crop=1" alt="" />
							</a>
						<? } ?>
					<? } ?>

					<? if (d.preview_videos) { ?>
						<? for (var i = 0, l = d.preview_videos.length; i < l; i++) { ?>
							<a class="digiseller-videothumb" data-id="<?= d.preview_videos[i].id ?>" data-type="<?= d.preview_videos[i].type ?>">
								<img src="<?= d.preview_videos[i].preview ?>" alt="" />
								<span></span>
							</a>
						<? } ?>
					<? } ?>
				</div>
			<? } ?>
		</div>
		
		<div class="digiseller-product-right">
			<?= buy ?>
			
			<? if (d.statistics.sales && d.statistics.sales != '0') { ?>
				<div class="digiseller-prod-info">
					<span><?= opts.i18n['numberOfSales'] ?>:&nbsp;</span><?= d.statistics.sales ?>
				</div>
			<? } ?>
		</div>
	</div>
	
	<div class="digiseller-both"></div>

	<div>		
		<div class="digiseller-productdetails-tabs">
			<a class="digiseller-activeTab" data-action="article-tab" data-tab="0"><?= opts.i18n['description'] ?></a>	
			<? if ((d.units && d.units.discounts) || (d.discounts && d.discounts.length)) { ?>
				<a data-action="article-tab" data-tab="1"><?= opts.i18n['discounts'] ?></a>	
			<? } ?>
			<? if (reviewsCount) { ?>
				<a data-action="article-tab" data-tab="2"><?= opts.i18n['reviews'] ?> (<?= reviewsCount ?>)</a>
			<? } ?>
		</div>
		<div>
			<div class="digiseller-description_content">
				<div class="digiseller-prod-info">
					<?= d.info ?>
				</div>

				<? if (d.add_info !== "") { ?>
					<div class="digiseller-prod-info">
						<h3><?= opts.i18n['addInformation'] ?>:</h3>
						<?= d.add_info ?>
					</div>
				<? } ?>
			</div>
			
			<div class="digiseller-reviews_content digiseller-discounttable2" style="display:none;">
				<? if ((d.units && d.units.discounts) || (d.discounts && d.discounts.length)) { ?>
				
					<? if (d.units && d.units.discounts) { ?>
						<h3><?= opts.i18n['discountsOnQuantityPurchases'] ?></h3>
						<table class="digiseller-discounttable1">
							<thead>
								<tr class="digiseller-discounttabbe-head">	
									<td><?= opts.i18n['whenBuyingFrom'] ?></td>
									<td><?= opts.i18n['discount'] ?></td>
									<td><?= opts.i18n['priceFor'] ?> <?= d.units.desc ?></td>
								</tr>
							</thead>
							<tbody>
								<? for (var i = 0, l = d.units.discounts.length; i < l; i++) { ?>
									<tr>
										<td><?= d.units.discounts[i].desc ?></td>
										<td><?= d.units.discounts[i].percent ?>%</td>
										<td><?= d.units.discounts[i].price ?> <?= d.currency ?></td>
									</tr>
								<? } ?>
							</tbody>
						</table><br />
					<? } ?> 
				
					<? if (d.discounts && d.discounts.length) { ?>
						<h3><?= opts.i18n['discountLoyalCustomers'] ?></h3>
						<table class="digiseller-discounttable1">
							<thead>
								<tr class="digiseller-discounttabbe-head">	
									<td><?= opts.i18n['amountOfPurchasesFrom'] ?></td>
									<td><?= opts.i18n['discount'] ?></td>
								</tr>
							</thead>
							<tbody>
								<? for (var i = 0, l = d.discounts.length; i < l; i++) { ?>
									<tr>
										<td><?= d.discounts[i].summa ?> <?= d.currency ?></td>
										<td><?= d.discounts[i].percent ?>%</td>
									</tr>
								<? } ?>
							</tbody>
						</table><br />
					<? } ?> 
				<? } ?>
			</div>
			
			<div class="digiseller-reviews_content" id="digiseller-article-comments-<?= d.id ?>" style="display:none;"></div>
		</div>
	</div>
</div>
<br />